---
description: 
globs: 
alwaysApply: false
---
База данных
Используемая СУБД:
SQLite (через пакет better-sqlite3)

Путь до базы на сервере
Путь:
./data/users.db
(обычно — если запуск из корня проекта: /home/your_user/myapp/data/users.db или аналогично)

-- Пользователи
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  name VARCHAR(255),
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  trial_end_at TIMESTAMP,
  subscription_status VARCHAR(50),
  last_login TIMESTAMP
);

-- Платежи
CREATE TABLE payments (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  amount NUMERIC(10,2) NOT NULL,
  payment_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  payment_status VARCHAR(50),
  payment_period VARCHAR(20),
  payment_gateway VARCHAR(50)
);

-- Агенты
CREATE TABLE agents (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  category VARCHAR(255),
  slug VARCHAR(255) UNIQUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  is_active BOOLEAN DEFAULT TRUE
);

-- Избранные агенты
CREATE TABLE favorite_agents (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  agent_id INTEGER REFERENCES agents(id),
  added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Последние агенты
CREATE TABLE recent_agents (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  agent_id INTEGER REFERENCES agents(id),
  viewed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
